# üè† HiTE PRO Gateway ‚Äî API –¢–µ—Å—Ç—ã

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã REST API —à–ª—é–∑–∞ —É–º–Ω–æ–≥–æ –¥–æ–º–∞ **HiTE PRO Gateway** –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ [–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API](https://cloud.mail.ru/public/k9he/nzDhMmiD6).

---

## 1.üîå –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### –£–ø—Ä–∞–≤–ª—è–µ–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

| –¢–∏–ø | –°–æ—Å—Ç–æ—è–Ω–∏–µ (`status`) | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (`command`) |
|-----|----------------------|------------------------|
| `switch` | `boolean` | `1` ‚Äì –í–∫–ª—é—á–∏—Ç—å<br>`2` ‚Äì –í—ã–∫–ª—é—á–∏—Ç—å<br>`3` ‚Äì –ò–º–ø—É–ª—å—Å |
| `dimmer` | `int` (0‚Äì100) | `0` ‚Äì –í—ã–∫–ª—é—á–∏—Ç—å<br>`1‚Äì100` ‚Äì –Ø—Ä–∫–æ—Å—Ç—å<br>`101` ‚Äì –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—à–ª—ã–π —É—Ä–æ–≤–µ–Ω—å |
| `drive` | `int`<br>`0=–û—Ç–∫—Ä—ã—Ç`<br>`1=–ó–∞–∫—Ä—ã—Ç`<br>`2=–û—Ç–∫—Ä—ã—Ç–∏–µ`<br>`3=–ó–∞–∫—Ä—ã—Ç–∏–µ` | `2` ‚Äì –û—Ç–∫—Ä—ã—Ç—å<br>`3` ‚Äì –ó–∞–∫—Ä—ã—Ç—å<br>`4` ‚Äì –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å |

### –¶–≤–µ—Ç–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

| –¢–∏–ø | –°–æ—Å—Ç–æ—è–Ω–∏–µ | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ |
|-----|----------|-----------|
| `LED3S/M` | `status: int (0‚Äì100)`<br>`color: string (HEX)` | `PUT /devices/{id}/{level}?color=fc0841` |
| `RGBW` | `status: int (0‚Äì100)`<br>`color: HEX`<br>`colorTemperature: int (0‚Äì3600)`<br>`effect: int (0‚Äì10)` | `PUT /devices/{id}/100?color=...`<br>`colorTemperature=1500‚Äì6500`<br>`effect=0‚Äì9` |

> ‚ö†Ô∏è –ü—Ä–∏ —á—Ç–µ–Ω–∏–∏ `colorTemperature` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `0‚Äì3600`, –ø—Ä–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –¥–æ–ø—É—Å—Ç–∏–º–æ `1500‚Äì6500`.

### –î–∞—Ç—á–∏–∫–∏ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)

| –¢–∏–ø | –§–æ—Ä–º–∞—Ç `status` | –ó–Ω–∞—á–µ–Ω–∏—è |
|-----|----------------|---------|
| `motion` | `boolean` | `true`/`false` |
| `illumination` | `int` | `0‚Äì100` |
| `temperature` | `float` | `-40 ‚Ä¶ +50` |
| `humidity` | `int` | `0‚Äì100` |
| `checker` | `int` | `0=–ó–∞–∫—Ä—ã—Ç–æ`, `1=–û—Ç–∫—Ä—ã—Ç–æ` |
| `water` | `int` | `0=–ù–æ—Ä–º–∞`, `1=–ó–∞–ª–∏–≤` |
| `power` | `int` | `0=–ù–µ—Ç –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è`, `1=–ï—Å—Ç—å` |
| `transmitter` | **–ù–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `status`** | –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ **webhook** |

---

## üì° –†–µ—Å—É—Ä—Å—ã API

- –ë–∞–∑–æ–≤—ã–π URI:
  - –õ–æ–∫–∞–ª—å–Ω—ã–π: `http://hitepro.local/rest/`
  - –ü–æ IP: `http://<IP>/rest/`
  - –í–Ω–µ—à–Ω–∏–π: `https://<–≤–Ω–µ—à–Ω–∏–π_–∫–ª—é—á>.connect-profi.ru/rest/`

- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: **Basic Auth**

- –ú–µ—Ç–æ–¥—ã:
  - `GET /devices/` ‚Üí —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
  - `GET /devices/{id}` ‚Üí —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–∏–ª–∏ `404`, –µ—Å–ª–∏ –Ω–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏)
  - `PUT /devices/{id}/{command}` ‚Üí —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  - `PUT /devices/{id}/{level}?color=...&colorTemperature=...&effect=...` ‚Üí RGBW
  - `GET /logs/device/?id=...` ‚Üí –ª–æ–≥–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
  - `GET /logs/scenario/?id=...` ‚Üí –ª–æ–≥–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è

- –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–∞:
  - `200` ‚Äì OK
  - `401` ‚Äì Unauthorized
  - `404` ‚Äì Not Found (—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –±–µ–∑ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –∏–ª–∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π ID)
  - `405` ‚Äì Method Not Allowed (–Ω–∞–ø—Ä–∏–º–µ—Ä, PUT –Ω–∞ –¥–∞—Ç—á–∏–∫)

---

## üß™ –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –ß—Ç–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞—Ç—á–∏–∫–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ª–µ, –¥–∏–º–º–µ—Ä–∞–º–∏, –ø—Ä–∏–≤–æ–¥–∞–º–∏
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–º, —Ü–≤–µ—Ç–æ–≤–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏ RGBW
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ (`401`, `404`, `405`)
- –ß—Ç–µ–Ω–∏–µ –ª–æ–≥–æ–≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
git clone https://github.com/cheryst24-code-qa/hitepro-api-tests.git
cd hitepro-api-tests
npm install
cp .env.example .env  # ‚Üê —É–∫–∞–∂–∏—Ç–µ HITEPRO_BASE_URL, USER, PASS
npm test
npx playwright show-report

```
ü§ñ CI/CD
- GitHub Actions: –∑–∞–ø—É—Å–∫ –ø—Ä–∏ push –∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (0 * * * *)
- Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ
- HTML-–æ—Ç—á—ë—Ç –∫–∞–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç
–ù–∞—Å—Ç—Ä–æ–π–∫–∞: –¥–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub.

üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- .env –∏—Å–∫–ª—é—á—ë–Ω –∏–∑ Git
- –°–µ–∫—Ä–µ—Ç—ã ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ GitHub Secrets
---
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
tests/devices.spec.js
.env.example
playwright.config.js

## 2. –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
.env —Å–æ–¥–µ—Ä–∂–∏—Ç:

HITEPRO_BASE_URL=https://–≤–∞—à_–∫–ª—é—á.connect-profi.ru/rest/  
HITEPRO_USER=admin  
HITEPRO_PASS=–ø–∞—Ä–æ–ª—å

- .env –≤ .gitignore
- –¢–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è: npx playwright test

## 3. Git –∏ GitHub
.gitignore —Å–æ–¥–µ—Ä–∂–∏—Ç:

node_modules/  
.env  
playwright-report/  
test-results/

- .env.example –±–µ–∑ –ø–∞—Ä–æ–ª–µ–π
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω –∏ –∫–æ–¥ –∑–∞–ø—É—â–µ–Ω

## 4. –°–µ–∫—Ä–µ—Ç—ã GitHub
–î–æ–±–∞–≤–ª–µ–Ω—ã –≤ Settings ‚Üí Secrets and variables ‚Üí Actions:
- HITEPRO_BASE_URL
- HITEPRO_USER
- HITEPRO_PASS
- TELEGRAM_BOT_TOKEN
- TELEGRAM_CHAT_ID

## 5. Workflow
–§–∞–π–ª: .github/workflows/api-tests.yml

–ü—Ä–æ–≤–µ—Ä–∫–∏:
- –¢—Ä–∏–≥–≥–µ—Ä—ã: push + schedule: '0 * * * *'
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π URL –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è "${{ steps.run_tests.outcome }}"
- –®–∞–≥ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram —Å parse_mode=HTML
- –ê—Ä—Ç–µ—Ñ–∞–∫—Ç: playwright-report

## 6. –ü–æ–∫—Ä—ã—Ç–∏–µ –ø–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç:
- switch: status: bool, –∫–æ–º–∞–Ω–¥—ã 1/2/3
- dimmer: 0‚Äì100, –∫–æ–º–∞–Ω–¥–∞ 101
- drive: —Å—Ç–∞—Ç—É—Å 0‚Äì3, –∫–æ–º–∞–Ω–¥—ã 2/3/4
- LED3S/M: color —á–µ—Ä–µ–∑ query-–ø–∞—Ä–∞–º–µ—Ç—Ä
- RGBW:
    - color (HEX),
    - colorTemperature –ø—Ä–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏: 1500‚Äì6500,
    - effect: 0‚Äì9
- –î–∞—Ç—á–∏–∫–∏:
    - motion ‚Üí bool,
    - temperature ‚Üí float (-40‚Ä¶+50),
    - checker/water/power ‚Üí 0/1,
    - illumination/humidity ‚Üí 0‚Äì100
- transmitter ‚Üí –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç status (–ø—Ä–æ–≤–µ—Ä–∫–∞ 404)
- –õ–æ–≥–∏: /logs/device/, /logs/scenario/
- –û—à–∏–±–∫–∏: 401, 404, 405

üîπ 7. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –æ—Ç—á—ë—Ç
- –ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤ ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ –∑–∞–ø—É—Å–∫
- HTML-–æ—Ç—á—ë—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç
- –í—Å–µ —à–∞–≥–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ –≤ GitHub Actions

- [üìã –ü–æ–ª–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CI/CD](docs/CI_CD_CHECKLIST.md)
